import { TypeList } from "docs-ui"

# IPaymentProvider

## Methods

### initiatePayment

#### Parameters

<TypeList types={[{"name":"data","type":"[InitiatePaymentInput](../types.InitiatePaymentInput/page.mdx)","description":"The data used initiate a payment in a provider when a payment\nsession is created.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"amount","type":"[BigNumberInput](../../types/types.BigNumberInput/page.mdx)","description":"The amount to be authorized.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"value","type":"`string` \\| `number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"numeric","type":"`number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"raw","type":"[BigNumberRawValue](../../types/types.BigNumberRawValue/page.mdx)","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"bigNumber","type":"`BigNumber`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"currency_code","type":"`string`","description":"The ISO 3 character currency code.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="initiatePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[InitiatePaymentOutput](../types.InitiatePaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"id","type":"`string`","description":"The ID of the payment session in the payment provider.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"status","type":"[PaymentSessionStatus](../../../payment/types/payment.PaymentSessionStatus/page.mdx)","description":"The status of the payment session, which will be stored in the payment session's `status` field.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="initiatePayment"/>

### updatePayment

#### Parameters

<TypeList types={[{"name":"data","type":"[UpdatePaymentInput](../types.UpdatePaymentInput/page.mdx)","description":"The attributes to update a payment related to a payment session in a provider.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"amount","type":"[BigNumberInput](../../types/types.BigNumberInput/page.mdx)","description":"The payment session's amount.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"value","type":"`string` \\| `number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"numeric","type":"`number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"raw","type":"[BigNumberRawValue](../../types/types.BigNumberRawValue/page.mdx)","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"bigNumber","type":"`BigNumber`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"currency_code","type":"`string`","description":"The ISO 3 character code of the payment session.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="updatePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[UpdatePaymentOutput](../types.UpdatePaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"status","type":"[PaymentSessionStatus](../../../payment/types/payment.PaymentSessionStatus/page.mdx)","description":"The status of the payment, which will be stored in the payment session's `status` field.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="updatePayment"/>

### deletePayment

#### Parameters

<TypeList types={[{"name":"data","type":"[DeletePaymentInput](../types.DeletePaymentInput/page.mdx)","description":"The data to delete a payment.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="deletePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[DeletePaymentOutput](../types.DeletePaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="deletePayment"/>

### authorizePayment

#### Parameters

<TypeList types={[{"name":"data","type":"[AuthorizePaymentInput](../types.AuthorizePaymentInput/page.mdx)","description":"The data to authorize a payment.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="authorizePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[AuthorizePaymentOutput](../types.AuthorizePaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"status","type":"[PaymentSessionStatus](../../../payment/types/payment.PaymentSessionStatus/page.mdx)","description":"The status of the payment, which will be stored in the payment session's `status` field.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="authorizePayment"/>

### capturePayment

#### Parameters

<TypeList types={[{"name":"data","type":"[CapturePaymentInput](../types.CapturePaymentInput/page.mdx)","description":"The data to capture a payment.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="capturePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[CapturePaymentOutput](../types.CapturePaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="capturePayment"/>

### refundPayment

#### Parameters

<TypeList types={[{"name":"data","type":"[RefundPaymentInput](../types.RefundPaymentInput/page.mdx)","description":"The data to refund a payment.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"amount","type":"[BigNumberInput](../../types/types.BigNumberInput/page.mdx)","description":"The amount to refund.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"value","type":"`string` \\| `number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"numeric","type":"`number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"raw","type":"[BigNumberRawValue](../../types/types.BigNumberRawValue/page.mdx)","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"bigNumber","type":"`BigNumber`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="refundPayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[RefundPaymentOutput](../types.RefundPaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="refundPayment"/>

### retrievePayment

#### Parameters

<TypeList types={[{"name":"data","type":"[RetrievePaymentInput](../types.RetrievePaymentInput/page.mdx)","description":"The data to retrieve a payment.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="retrievePayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[RetrievePaymentOutput](../types.RetrievePaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="retrievePayment"/>

### cancelPayment

#### Parameters

<TypeList types={[{"name":"data","type":"[CancelPaymentInput](../types.CancelPaymentInput/page.mdx)","description":"The data to cancel a payment.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="cancelPayment"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[CancelPaymentOutput](../types.CancelPaymentOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="cancelPayment"/>

### retrieveAccountHolder

<BadgesList badges={[
  {
    "variant": "neutral",
    "children": "optional"
  }
]} className="mb-1" />

This method is used when retrieving an account holder in Medusa, allowing you to retrieve
the equivalent account in the third-party payment provider. An account holder is useful to
later save payment methods, such as credit cards, for a customer in the
third-party payment provider using the [savePaymentMethod](page.mdx#savepaymentmethod) method.

:::note

This is available starting from [Medusa v2.11.0](https://github.com/medusajs/medusa/releases/tag/v2.11.0).

:::

#### Example

```ts
import { MedusaError } from "@medusajs/framework/utils"

class MyPaymentProviderService extends AbstractPaymentProvider<
 Options
> {
 async retrieveAccountHolder({ id }: RetrieveAccountHolderInput) {

  // assuming you have a client that retrieves the account holder
  const providerAccountHolder = await this.client.retrieveAccountHolder({
    id
  })

  return {
    id: providerAccountHolder.id,
    data: providerAccountHolder as unknown as Record<string, unknown>
  }
}
```

#### Parameters

<TypeList types={[{"name":"data","type":"[RetrieveAccountHolderInput](../types.RetrieveAccountHolderInput/page.mdx)","description":"Input data including the details of the account holder to retrieve.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"id","type":"`string`","description":"The ID of the account holder to retrieve.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="retrieveAccountHolder"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[RetrieveAccountHolderOutput](../types.RetrieveAccountHolderOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"The retrieved account holder. If an error occurs, throw it.","expandable":false,"children":[{"name":"id","type":"`string`","description":"The ID of the account holder in the payment provider.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}],"since":"2.11.0"}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="retrieveAccountHolder"/>

### createAccountHolder

<BadgesList badges={[
  {
    "variant": "neutral",
    "children": "optional"
  }
]} className="mb-1" />

This method is used when creating an account holder in Medusa, allowing you to create
the equivalent account in the third-party payment provider. An account holder is useful to
later save payment methods, such as credit cards, for a customer in the
third-party payment provider using the [savePaymentMethod](page.mdx#savepaymentmethod) method.

The returned data will be stored in the account holder created in Medusa. For example,
the returned `id` property will be stored in the account holder's `external_id` property.

Medusa creates an account holder when a payment session initialized for a registered customer.

:::note

This is available starting from [Medusa v2.5.0](https://github.com/medusajs/medusa/releases/tag/v2.5.0).

:::

#### Example

```ts
import { MedusaError } from "@medusajs/framework/utils"

class MyPaymentProviderService extends AbstractPaymentProvider<
 Options
> {
 async createAccountHolder({ context, data }: CreateAccountHolderInput) {
  const { account_holder, customer } = context

  if (account_holder?.data?.id) {
    return { id: account_holder.data.id as string }
  }

  if (!customer) {
    throw new MedusaError(
      MedusaError.Types.INVALID_DATA,
      "Missing customer data."
    )
  }

  // assuming you have a client that creates the account holder
  const providerAccountHolder = await this.client.createAccountHolder({
    email: customer.email,
   ...data
  })

  return {
    id: providerAccountHolder.id,
    data: providerAccountHolder as unknown as Record<string, unknown>
  }
}
```

#### Parameters

<TypeList types={[{"name":"data","type":"[CreateAccountHolderInput](../types.CreateAccountHolderInput/page.mdx)","description":"Input data including the details of the account holder to create.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"context","type":"Omit&#60;[PaymentProviderContext](../types.PaymentProviderContext/page.mdx), \"customer\"&#62; & `object`","description":"The context of creating the account holder.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The account holder's associated customer details.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="createAccountHolder"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[CreateAccountHolderOutput](../types.CreateAccountHolderOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"The result of creating the account holder. If an error occurs, throw it.","expandable":false,"children":[{"name":"id","type":"`string`","description":"The ID of the account holder in the payment provider.\nThis is stored in Medusa's account holder in the `external_id` property.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}],"since":"2.5.0"}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="createAccountHolder"/>

### updateAccountHolder

<BadgesList badges={[
  {
    "variant": "neutral",
    "children": "optional"
  }
]} className="mb-1" />

This method is used when updating an account holder in Medusa, allowing you to update
the equivalent account in the third-party payment provider.

The returned data will be stored in the account holder created in Medusa. For example,
the returned `id` property will be stored in the account holder's `external_id` property.

:::note

This is available starting from [Medusa v2.5.1](https://github.com/medusajs/medusa/releases/tag/v2.5.1).

:::

#### Example

```ts
import { MedusaError } from "@medusajs/framework/utils"

class MyPaymentProviderService extends AbstractPaymentProvider<
 Options
> {
 async updateAccountHolder({ context, data }: UpdateAccountHolderInput) {
  const { account_holder, customer } = context

  if (!account_holder?.data?.id) {
    throw new MedusaError(
      MedusaError.Types.INVALID_DATA,
      "Missing account holder ID."
    )
  }

  // assuming you have a client that updates the account holder
  const providerAccountHolder = await this.client.updateAccountHolder({
    id: account_holder.data.id,
   ...data
  })

  return {
    id: providerAccountHolder.id,
    data: providerAccountHolder as unknown as Record<string, unknown>
  }
}
```

#### Parameters

<TypeList types={[{"name":"data","type":"[UpdateAccountHolderInput](../types.UpdateAccountHolderInput/page.mdx)","description":"Input data including the details of the account holder to update.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx) & `object`","description":"The context of updating the account holder.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder's details.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="updateAccountHolder"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[UpdateAccountHolderOutput](../types.UpdateAccountHolderOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"The result of updating the account holder. If an error occurs, throw it.","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}],"since":"2.5.1"}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="updateAccountHolder"/>

### deleteAccountHolder

<BadgesList badges={[
  {
    "variant": "neutral",
    "children": "optional"
  }
]} className="mb-1" />

This method is used when an account holder is deleted in Medusa, allowing you
to also delete the equivalent account holder in the third-party payment provider.

:::note

This is available starting from [Medusa v2.5.0](https://github.com/medusajs/medusa/releases/tag/v2.5.0).

:::

#### Example

```ts
import { MedusaError } from "@medusajs/framework/utils"

class MyPaymentProviderService extends AbstractPaymentProvider<
 Options
> {
  async deleteAccountHolder({ context }: DeleteAccountHolderInput) {
    const { account_holder } = context
    const accountHolderId = account_holder?.data?.id as string | undefined
    if (!accountHolderId) {
      throw new MedusaError(
        MedusaError.Types.INVALID_DATA,
        "Missing account holder ID."
      )
    }

    // assuming you have a client that deletes the account holder
    await this.client.deleteAccountHolder({
      id: accountHolderId
    })

    return {}
  }
}
```

#### Parameters

<TypeList types={[{"name":"data","type":"[DeleteAccountHolderInput](../types.DeleteAccountHolderInput/page.mdx)","description":"Input data including the details of the account holder to delete.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"context","type":"Omit&#60;[PaymentProviderContext](../types.PaymentProviderContext/page.mdx), \"account_holder\"&#62; & `object`","description":"The context of deleting the account holder.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"Partial&#60;[AccountHolderDTO](../../../payment/interfaces/payment.AccountHolderDTO/page.mdx)&#62;","description":"The account holder's details.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="deleteAccountHolder"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[DeleteAccountHolderOutput](../types.DeleteAccountHolderOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"The result of deleting the account holder. If an error occurs, throw it.","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}],"since":"2.5.0"}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="deleteAccountHolder"/>

### listPaymentMethods

<BadgesList badges={[
  {
    "variant": "neutral",
    "children": "optional"
  }
]} className="mb-1" />

This method is used to retrieve the list of saved payment methods for an account holder
in the third-party payment provider. A payment provider that supports saving payment methods
must implement this method.

:::note

This is available starting from [Medusa v2.5.0](https://github.com/medusajs/medusa/releases/tag/v2.5.0).

:::

#### Example

```ts
import { MedusaError } from "@medusajs/framework/utils"

class MyPaymentProviderService extends AbstractPaymentProvider<
  Options
> {
  async listPaymentMethods({ context }: ListPaymentMethodsInput) {
    const { account_holder } = context
    const accountHolderId = account_holder?.data?.id as string | undefined

    if (!accountHolderId) {
      throw new MedusaError(
        MedusaError.Types.INVALID_DATA,
        "Missing account holder ID."
      )
    }

   // assuming you have a client that lists the payment methods
   const paymentMethods = await this.client.listPaymentMethods({
     customer_id: accountHolderId
   })

   return paymentMethods.map((pm) => ({
     id: pm.id,
     data: pm as unknown as Record<string, unknown>
   }))
 }
}
```

#### Parameters

<TypeList types={[{"name":"data","type":"[ListPaymentMethodsInput](../types.ListPaymentMethodsInput/page.mdx)","description":"Input data including the details of the account holder to list payment methods for.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="listPaymentMethods"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ListPaymentMethodsOutput](../types.ListPaymentMethodsOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"The list of payment methods saved for the account holder. If an error occurs, throw it.","expandable":false,"children":[{"name":"ListPaymentMethodsOutput","type":"`object`","description":"The result of listing payment methods for an account holder in the third-party payment provider.","optional":false,"defaultValue":"","expandable":false,"children":[]}],"since":"2.5.0"}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="listPaymentMethods"/>

### savePaymentMethod

<BadgesList badges={[
  {
    "variant": "neutral",
    "children": "optional"
  }
]} className="mb-1" />

This method is used to save a customer's payment method, such as a credit card, in the
third-party payment provider. A payment provider that supports saving payment methods
must implement this method.

:::note

This is available starting from [Medusa v2.5.0](https://github.com/medusajs/medusa/releases/tag/v2.5.0).

:::

#### Example

```ts
import { MedusaError } from "@medusajs/framework/utils"

class MyPaymentProviderService extends AbstractPaymentProvider<
  Options
> {
  async savePaymentMethod({ context, data }: SavePaymentMethodInput) {   *
    const accountHolderId = context?.account_holder?.data?.id as
      | string
      | undefined

    if (!accountHolderId) {
      throw new MedusaError(
        MedusaError.Types.INVALID_DATA,
        "Missing account holder ID."
      )
    }

   // assuming you have a client that saves the payment method
   const paymentMethod = await this.client.savePaymentMethod({
     customer_id: accountHolderId,
     ...data
   })

  return {
    id: paymentMethod.id,
    data: paymentMethod as unknown as Record<string, unknown>
  }
 }
}
```

#### Parameters

<TypeList types={[{"name":"data","type":"[SavePaymentMethodInput](../types.SavePaymentMethodInput/page.mdx)","description":"The details of the payment method to save.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="savePaymentMethod"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[SavePaymentMethodOutput](../types.SavePaymentMethodOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"The result of saving the payment method. If an error occurs, throw it.","expandable":false,"children":[{"name":"id","type":"`string`","description":"The ID of the payment method in the payment provider.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}],"since":"2.5.0"}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="savePaymentMethod"/>

### getPaymentStatus

#### Parameters

<TypeList types={[{"name":"data","type":"[GetPaymentStatusInput](../types.GetPaymentStatusInput/page.mdx)","description":"The data to get the payment status.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"data","type":"`Record<string, unknown>`","description":"Data is a combination of the input from the user and what is stored in the database for the associated model.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"[PaymentProviderContext](../types.PaymentProviderContext/page.mdx)","description":"The context for this payment operation. The data is guaranteed to be validated and not directly provided by the user.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"account_holder","type":"[PaymentAccountHolderDTO](../../types/types.PaymentAccountHolderDTO/page.mdx)","description":"The account holder information, if available for the payment provider.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"customer","type":"[PaymentCustomerDTO](../../types/types.PaymentCustomerDTO/page.mdx)","description":"The customer information from Medusa.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotency_key","type":"`string`","description":"Idempotency key for the request, if the payment provider supports it. It will be ignored otherwise.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="getPaymentStatus"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[GetPaymentStatusOutput](../types.GetPaymentStatusOutput/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"status","type":"[PaymentSessionStatus](../../../payment/types/payment.PaymentSessionStatus/page.mdx)","description":"The status of the payment, which will be stored in the payment session's `status` field.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"`Record<string, unknown>`","description":"The unstructured data returned from the payment provider. The content will vary between providers.","optional":true,"defaultValue":"","expandable":false,"children":[]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="getPaymentStatus"/>

### getWebhookActionAndData

#### Parameters

<TypeList types={[{"name":"data","type":"`object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="getWebhookActionAndData"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[WebhookActionResult](../types.WebhookActionResult/page.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[{"name":"action","type":"[PaymentActions](../../types/types.PaymentActions/page.mdx)","description":"The action that was performed so that Medusa can handle it internally.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"data","type":"[WebhookActionData](../types.WebhookActionData/page.mdx)","description":"The webhook action's details.","optional":true,"defaultValue":"","expandable":false,"children":[{"name":"session_id","type":"`string`","description":"The ID of the payment session in Medusa.\nMake sure to store this ID in the third-party payment provider\nto be able to retrieve the payment session later.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"amount","type":"[BigNumberValue](../../types/types.BigNumberValue/page.mdx)","description":"The amount to be captured or authorized (based on the action's type.)","optional":false,"defaultValue":"","expandable":false,"children":[]}]}]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="getWebhookActionAndData"/>
